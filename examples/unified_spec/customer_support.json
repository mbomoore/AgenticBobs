{
  "name": "Customer Support Process",
  "case_schema": {
    "tickets": {
      "id": "integer",
      "subject": "string",
      "body": "string",
      "status": "string",
      "category": "string",
      "agent_id": "integer",
      "resolution_email_sent": "boolean"
    },
    "agents": {
      "id": "integer",
      "name": "string",
      "expertise": "string"
    },
    "emails": {
      "id": "integer",
      "ticket_id": "integer",
      "recipient": "string",
      "body": "string"
    }
  },
  "views": [
    {
      "name": "new_tickets",
      "query": "SELECT * FROM tickets WHERE status = 'new'"
    },
    {
      "name": "uncategorized_tickets",
      "query": "SELECT id, subject, body FROM tickets WHERE category IS NULL AND status = 'new'"
    },
    {
      "name": "billing_tickets_to_assign",
      "query": "SELECT id FROM tickets WHERE category = 'billing' AND agent_id IS NULL"
    },
    {
      "name": "technical_tickets_to_assign",
      "query": "SELECT id FROM tickets WHERE category = 'technical' AND agent_id IS NULL"
    },
    {
      "name": "unresolved_tickets",
      "query": "SELECT * FROM tickets WHERE status = 'assigned'"
    },
    {
      "name": "resolved_tickets_for_email",
      "query": "SELECT id, subject FROM tickets WHERE status = 'resolved' AND resolution_email_sent = false"
    }
  ],
  "work_units": [
    {
      "name": "categorize_ticket",
      "goal_tag": "ai_categorize",
      "inputs": ["uncategorized_tickets"],
      "outputs": ["tickets"],
      "done_condition": "(SELECT COUNT(*) FROM tickets WHERE category IS NULL AND status = 'new') == 0"
    },
    {
      "name": "assign_billing_ticket",
      "goal_tag": "ai_assign",
      "inputs": ["billing_tickets_to_assign"],
      "outputs": ["tickets"],
      "done_condition": "(SELECT COUNT(*) FROM tickets WHERE category = 'billing' AND agent_id IS NULL) == 0"
    },
    {
      "name": "assign_technical_ticket",
      "goal_tag": "ai_assign",
      "inputs": ["technical_tickets_to_assign"],
      "outputs": ["tickets"],
      "done_condition": "(SELECT COUNT(*) FROM tickets WHERE category = 'technical' AND agent_id IS NULL) == 0"
    },
    {
      "name": "resolve_ticket_by_human",
      "goal_tag": "human_resolve",
      "inputs": ["unresolved_tickets"],
      "outputs": ["tickets"],
      "done_condition": "False"
    },
    {
      "name": "send_resolution_email",
      "goal_tag": "system_email",
      "inputs": ["resolved_tickets_for_email"],
      "outputs": ["emails", "tickets"],
      "done_condition": "(SELECT COUNT(*) FROM tickets WHERE status = 'resolved' AND resolution_email_sent = false) == 0"
    }
  ],
  "combinators": [],
  "execution_bindings": [
    {
      "goal_tag": "ai_categorize",
      "executor": "ai_agent"
    },
    {
      "goal_tag": "ai_assign",
      "executor": "ai_agent"
    },
    {
      "goal_tag": "human_resolve",
      "executor": "human"
    },
    {
      "goal_tag": "system_email",
      "executor": "system"
    }
  ]
}
